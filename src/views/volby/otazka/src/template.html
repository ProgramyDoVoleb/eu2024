<div class="layout-volby-questions">
	<p-layout-divided>
		<template #main>
			<p-block :headline="data ? data.list[0].question : 'Načítám otázku'" :level="1" :hide="true">
				<p-loader :rule="data">
					<div v-if="data">
						<p-area v-if="data">
							<div class="p-offset">
								<div>
									<p-box-icon type="answers"></p-box-icon>
								</div>
								<div>
									<strong>Volební otázky pro {{ enums.elections.find(x => x.key === data.cis.volby[0].typ).name.toLowerCase() }}</strong>
									<div class="smaller">
										{{ data.cis.volby[0].datum_label || data.cis.volby[0].cirka || date(data.cis.volby[0].datum) }}
										<template v-if="data && $route.query.vyber && hash === 'krajske-volby'">
											&middot; <router-link :to="'/volby/' + hash + '/' + id + '/kraj/' + $route.query.vyber">{{ enums.regions[$route.query.vyber - 1] }}</router-link>
										</template>
										<template v-if="data && $route.query.vyber && hash === 'senatni-volby'">
											&middot; <router-link :to="'/volby/' + hash + '/' + id + '/obvod/' + $route.query.vyber">obvod {{ $route.query.vyber }}</router-link>
										</template>
									</div>
								</div>
							</div>
						</p-area>
						<div class="p-gap"></div>
						<p-headline :level="1">{{ data ? data.list[0].question : 'Načítám otázku' }}</p-headline>
						<p class="lead" v-if="data && data.list[0].comment">{{ data.list[0].comment }}</p>
						<template v-if="['senatni-volby', 'prezidentske-volby', 'evropske-volby'].indexOf(hash) > -1">
							<div class="p-gap"></div>
							<p-list height="2">
								<template v-for="(cand, index2) in sortByDeepPrijmeni(data.list[0].$body)">
									<div>
										<p-block :headline="cand.$kandidat.JMENO + ' ' + cand.$kandidat.PRIJMENI" :hide="true" class="_npm">
											<router-link :to="'/volby/' + hash + '/' + id + '/kandidat/' + cand.$kandidat.id"><strong>{{ cand.$kandidat.JMENO + ' ' + cand.$kandidat.PRIJMENI }}</strong></router-link> <span class="dimm smallest">&middot; {{ cand.$kandidat.PORCISLO }} </span> 
											<div v-if="onlyLast(data.list[0].$odpovedi.filter(x => x.csu_table === cand.csu_table && x.csu_id === cand.csu_id)).quick">
												<span class="dimm">Rychlá odpověď: </span> {{ ['', 'ANO', 'NE', 'je to komplikované', 'nechci odpovídat'][onlyLast(data.list[0].$odpovedi.filter(x => x.csu_table === cand.csu_table && x.csu_id === cand.csu_id)).quick] }}
											</div>
											<div v-if="onlyLast(data.list[0].$odpovedi.filter(x => x.csu_table === cand.csu_table && x.csu_id === cand.csu_id)).answer">
												<p-truncated :content="onlyLast(data.list[0].$odpovedi.filter(x => x.csu_table === cand.csu_table && x.csu_id === cand.csu_id)).answer" :size="60" class="serif"></p-truncated>
											</div>
		
										</p-block>
									</div>
								</template>
							</p-list>
						</template>
						<template v-if="['evropske-volby', 'snemovni-volby', 'komunalni-volby', 'krajske-volby'].indexOf(hash) > -1">
							<template v-if="$strany">
								<template v-for="(party, index) in $strany">
									<p-block :headline="party.NAZEV" :hide="true" class="_npm" :anchor="party.ZKRATKA || party.NAZEV">
										<p-collapsible :label="party.NAZEV" :logo="logoByItem(party, data)" :status="sortByDeepPorCislo(data.list[0].$body.filter(x => x.$strana && x.$strana.id === party.id && x.$kandidat)).length">
											<p-area>
												<div v-if="data.list[0].$odpovedi.filter(x => x.csu_id === party.id).length > 0">
													<div v-if="onlyLast(data.list[0].$odpovedi.filter(x => x.csu_id === party.id)).quick" class="smaller strong">
														<span class="dimm">Rychlá odpověď: </span> {{ ['', 'ANO', 'NE', 'je to komplikované', 'jiná odpověď'][onlyLast(data.list[0].$odpovedi.filter(x => x.csu_id === party.id)).quick] }}
													</div>
													<div v-if="onlyLast(data.list[0].$odpovedi.filter(x => x.csu_id === party.id)).answer">
														<p-truncated :content="onlyLast(data.list[0].$odpovedi.filter(x => x.csu_id === party.id)).answer" :size="60" class="serif"></p-truncated>
													</div>
												</div>
												<p-list v-if="data.list[0].$body.filter(x => x.$strana && x.$strana.id === party.id && x.$kandidat).length > 0">
													<template v-for="(cand, index2) in sortByDeepPorCislo(data.list[0].$body.filter(x => x.$strana && x.$strana.id === party.id && x.$kandidat))">
														<div>
																<router-link :to="'/volby/' + hash + '/' + id + '/kandidat/' + cand.$kandidat.id"><strong>{{ cand.$kandidat.JMENO + ' ' + cand.$kandidat.PRIJMENI }}</strong></router-link> <span class="dimm smallest">&middot; {{ cand.$kandidat.PORCISLO }} </span> 
																<div v-if="onlyLast(data.list[0].$odpovedi.filter(x => x.csu_table === cand.csu_table && x.csu_id === cand.csu_id)).quick">
																	<span class="dimm">Rychlá odpověď: </span> {{ ['', 'ANO', 'NE', 'je to komplikované', 'nechci odpovídat'][onlyLast(data.list[0].$odpovedi.filter(x => x.csu_table === cand.csu_table && x.csu_id === cand.csu_id)).quick] }}
																</div>
																<div v-if="onlyLast(data.list[0].$odpovedi.filter(x => x.csu_table === cand.csu_table && x.csu_id === cand.csu_id)).answer">
																	<p-truncated :content="onlyLast(data.list[0].$odpovedi.filter(x => x.csu_table === cand.csu_table && x.csu_id === cand.csu_id)).answer" :size="60" class="serif"></p-truncated>
																</div>
														</div>
													</template>
												</p-list>
											</p-area>
											<div class="p-gap_05"></div>
											<div class="smallest dimm">
												<p-label :color="colorByItem(party, data)">
													<router-link :to="'/volby/' + hash + '/' + id + '/strana/' + party.csu_id">{{ party.NAZEV }} podrobně</router-link>
													&middot;
													<router-link :to="'/volby/' + hash + '/' + id + '/strana/' + party.csu_id + '/otazky-a-odpovedi'">ostatní odpovědi</router-link>
												</p-label>
											</div>
										</p-collapsible>
									</p-block>
								</template>
							</template>
						</template>
					</div>
				</p-loader>
			</p-block>
			<p-block headline="Další otázky" :level="1" v-if="data">
				<template v-for="(qitem, qindex) in qenum">
					<p-collapsible :label="qitem.label" :status="data.cis.otazky.filter(x => x.type === qitem.type && qitem.designee === x.designated).length" v-if="data.cis.otazky.filter(x => x.type === qitem.type && qitem.designee === x.designated).length > 0">
						<p-area>
							<div class="p-list">
								<div v-for="(qquestion, qqindex) in data.cis.otazky.filter(x => x.type === qitem.type && x.priority === 1 && qitem.designee === x.designated)">
									<router-link class="strong" :to="'/volby/' + hash + '/' + id + '/' + qitem.hash + '/' + qquestion.id">{{ qquestion.question }}</router-link>
									<div class="smaller" v-if="qquestion.comment">{{ truncate(qquestion.comment, 12) }}</div>
								</div>
							</div>
							<template v-if="data.cis.otazky.find(x => x.type === qitem.type && x.priority === 2)">
								<div class="p-gap"></div>
								<p-collapsible label="Doplňkové otázky">
									<div class="p-list">
										<div v-for="(qquestion, qqindex) in data.cis.otazky.filter(x => x.type === qitem.type && x.priority === 2 && qitem.designee === x.designated)">
											<router-link :to="'/volby/' + hash + '/' + id + '/' + qitem.hash + '/' + qquestion.id">{{ qquestion.question }}</router-link>
										</div>
									</div>
								</p-collapsible>
							</template>
						</p-area>
					</p-collapsible>
				</template>
			</p-block>
		</template>
		<template #anchors>
			<p-logo :data="{logo: cdn + 'icon/' + $route.fullPath.split('/')[2] + '.svg'}" :size="'12rem'"></p-logo>
			<div class="p-gap"></div>
			<p-anchors></p-anchors>
		</template>
		<template #aside>
			...
		</template>
	</p-layout-divided>
</div>